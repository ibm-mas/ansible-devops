<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>registry - MAS DevOps Ansible Collection</title>

    <!-- Pure CSS (https://pure-css.github.io/) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css" integrity="sha384-X38yfunGUhNzHpBaEBsWLO+A0HDYOQi8ufWDkZ0k9e0eXz/tH3II7uKZ9msv++Ls" crossorigin="anonymous">
    <link rel="stylesheet" href="../../css/theme.css">

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha256-3edrmyuQ0w65f8gfBsqowzjJe2iM6n0nKciPUp8y+7E=" crossorigin="anonymous"></script>
    <script src="../../js/theme.js"></script>

    <!-- Carbon theme zones (white, g10, g90, g100) -->
    <link rel="stylesheet" href="https://1.www.s81c.com/common/carbon/web-components/tag/latest/themes.css" />

    <!-- The Carbon web-components/framework -->
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/ui-shell.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/accordion.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/breadcrumb.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/select.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/tabs.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/search.min.js"></script>

    <!-- HighlightJS code formatting support -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
    <script>hljs.highlightAll();</script>

    <!-- Required by MkDocs search -->
    <script>var base_url = "../..";</script>

    <!-- User defined extras -->
    
    

    

    
    <script src="../../search/main.js"></script>
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: black; }</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>

  <body>
    <cds-header aria-label="MAS DevOps Ansible Collection" class="cds-theme-zone-g100">
      <cds-header-menu-button button-label-active="Close menu" button-label-inactive="Open menu"></cds-header-menu-button>
      <cds-header-name href="../.." prefix="IBM">MAS DevOps Ansible Collection</cds-header-name>
      <cds-header-nav menu-bar-label="IBM MAS DevOps Ansible Collection">
          <cds-header-nav-item is-active target="" href="">Ansible</cds-header-nav-item>
          <cds-header-nav-item  target="" href="https://ibm-mas.github.io/cli/">CLI</cds-header-nav-item>
      </cds-header-nav>

      <div class="cds--header__global">
        <cds-search id="header-search" label-text="Search" cds-search-input="search-event" expandable></cds-search>
      </div>
      <script>
        var el = document.getElementById("header-search");
        el.addEventListener("cds-search-input", function (ev) {
          console.info(ev.detail.value)
          document.getElementById("header-search-value").setAttribute("value", ev.detail.value);
        });
        el.addEventListener('keydown', function (ev) {
          if (ev.key === 'Enter') {
            location.href="../../search.html?q=" + document.querySelector("#header-search").shadowRoot.querySelector("#input").value;
          }
        });
      </script>

      
        <cds-header-nav>
          <cds-header-nav-item href="https://github.com/ibm-mas/ansible-devops/blob/master/docs/roles/registry.md">Edit on GitHub</cds-header-nav-item>
        </cds-header-nav>
      

    </cds-header>

    <cds-side-nav aria-label="Side navigation" class="cds-theme-zone-g90">
      <cds-side-nav-items>
        
          
  <cds-side-nav-menu title="General Information" >
    
      
  <cds-side-nav-menu-item href="../.." >
    Home
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../execution-environment/" >
    Ansible Automation Platform
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Playbooks" >
    
      
  <cds-side-nav-menu-item href="../../playbooks/ocp/" >
    OCP
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/cp4d/" >
    Install Cloud Pak For Data
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/oneclick-core/" >
    Install Core
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/oneclick-aibroker/" >
    Add AIBroker
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/oneclick-iot/" >
    Add IoT
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/oneclick-manage/" >
    Add Manage
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/oneclick-monitor/" >
    Add Monitor
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/oneclick-optimizer/" >
    Add Optimizer
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/oneclick-predict/" >
    Add Predict
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/oneclick-visualinspection/" >
    Add Visual Inspection
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/oneclick-facilities/" >
    Add Real Estate and Facilities
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/oneclick-update/" >
    Update
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/oneclick-upgrade/" >
    Upgrade
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/uninstall-core/" >
    Uninstall Core
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/backup-restore/" >
    Backup & Restore
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Roles: OCP Mgmt" >
    
      
  <cds-side-nav-menu-item href="../ocp_cluster_monitoring/" >
    ocp_cluster_monitoring
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_config/" >
    ocp_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_deprovision/" >
    ocp_deprovision
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_efs/" >
    ocp_efs
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_github_oauth/" >
    ocp_github_oauth
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_login/" >
    ocp_login
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_node_config/" >
    ocp_node_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_provision/" >
    ocp_provision
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_roks_upgrade_registry_storage/" >
    ocp_roks_upgrade_registry_storage
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_upgrade/" >
    ocp_upgrade
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_verify/" >
    ocp_verify
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Roles: Dependency Mgmt" >
    
      
  <cds-side-nav-menu-item href="../appconnect/" >
    appconnect
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../aws_bucket_access_point/" >
    aws_bucket_access_point
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../aws_documentdb_user/" >
    aws_documentdb_user
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../aws_policy/" >
    aws_policy
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../aws_route53/" >
    aws_route53
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../aws_user_creation/" >
    aws_user_creation
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../aws_vpc/" >
    aws_vpc
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../cert_manager/" >
    cert_manager
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../cis/" >
    cis
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../common_services/" >
    common-services
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../configure_manage_eventstreams/" >
    configure_manage_eventstreams
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../cos/" >
    cos
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../cos_bucket/" >
    cos_bucket
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../cp4d_admin_pwd_update/" >
    cp4d_admin_pwd_update
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../cp4d/" >
    cp4d
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../cp4d_service/" >
    cp4d_service
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../db2/" >
    db2
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../dro/" >
    dro
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../eck/" >
    eck
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../grafana/" >
    grafana
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ibm_catalogs/" >
    ibm_catalogs
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../kafka/" >
    kafka
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../nvidia_gpu/" >
    nvidia_gpu
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../mongodb/" >
    mongodb
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocs/" >
    ocs
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../sls/" >
    sls
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../turbonomic/" >
    turbonomic
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../uds/" >
    uds
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Roles: Image Mirroring" active expanded>
    
      
  <cds-side-nav-menu-item href="../mirror_case_prepare/" >
    mirror_case_prepare
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../mirror_extras_prepare/" >
    mirror_extras_prepare
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../mirror_images/" >
    mirror_images
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../mirror_ocp/" >
    mirror_ocp
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_idms/" >
    ocp_idms
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_simulate_disconnected_network/" >
    ocp_simulate_disconnected_network
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="./" active expanded>
    registry
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Roles: Suite Mgmt" >
    
      
  <cds-side-nav-menu-item href="../suite_app_config/" >
    suite_app_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_app_install/" >
    suite_app_install
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_app_uninstall/" >
    suite_app_uninstall
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_app_upgrade/" >
    suite_app_upgrade
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_app_rollback/" >
    suite_app_rollback
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_app_backup_restore/" >
    suite_app_backup_restore
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_certs/" >
    suite_certs
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_config/" >
    suite_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_db2_setup_for_manage/" >
    suite_db2_setup_for_manage
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_dns/" >
    suite_dns
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_install/" >
    suite_install
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_attachments_config/" >
    suite_manage_attachments_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_birt_report_config/" >
    suite_manage_birt_report_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_bim_config/" >
    suite_manage_bim_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_customer_files_config/" >
    suite_manage_customer_files_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_imagestitching_config/" >
    suite_manage_imagestitching_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_import_certs_config/" >
    suite_manage_import_certs_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_load_dbc_scripts/" >
    suite_manage_load_dbc_scripts
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_logging_config/" >
    suite_manage_logging_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_pvc_config/" >
    suite_manage_pvc_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_uninstall/" >
    suite_uninstall
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_upgrade/" >
    suite_upgrade
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_rollback/" >
    suite_rollback
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_verify/" >
    suite_verify
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_backup_restore/" >
    suite_backup_restore
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Roles: Utilities" >
    
      
  <cds-side-nav-menu-item href="../ansible_version_check/" >
    ansible_version_check
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../entitlement_key_rotation/" >
    entitlement_key_rotation
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../gencfg_jdbc/" >
    gencfg_jdbc
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../gencfg_watsonstudio/" >
    gencfg_watsonstudio
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../gencfg_workspace/" >
    gencfg_workspace
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../gencfg_mongo/" >
    gencfg_mongo
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
      </cds-side-nav-items>
    </cds-side-nav>

    <div id="breadcrumbs" class="rst-content"><cds-breadcrumb no-trailing-slash>
  <cds-breadcrumb-item>
    <cds-breadcrumb-link href="../..">Home</cds-breadcrumb-link>
  </cds-breadcrumb-item>
      <cds-breadcrumb-item>Roles: Image Mirroring</cds-breadcrumb-item>

  <cds-breadcrumb-item aria-current="page">
    <cds-breadcrumb-link href="#registry">registry</cds-breadcrumb-link>
  </cds-breadcrumb-item>

  <cds-breadcrumb-item>
    <cds-select id="breadcrumbs-toc" class="cds-theme-zone-g10" inline placeholder="..." oninput="changeAnchor(this.value)">
    
    
      <cds-select-item value="#usage">Usage</cds-select-item>
    
      <cds-select-item value="#usage-for-tear-down-action">Usage for tear-down action</cds-select-item>
    
      <cds-select-item value="#role-variables">Role Variables</cds-select-item>
    
      <cds-select-item value="#example-playbook">Example Playbook</cds-select-item>
    
      <cds-select-item value="#license">License</cds-select-item>
    
  </cds-select>
  </cds-breadcrumb-item>
</cds-breadcrumb>
    </div>

    <div id="main-content" class="rst-content">
      
      <h1 id="registry">registry<a class="headerlink" href="#registry" title="Permanent link">¤</a></h1>
<p>Create a Docker Registry running on RedHat OpenShift cluster.  The registry will be backed by persistant storage, and accessible via either a clusterIP or loadbalancer service. This role can also be used to delete a docker registry on a cluster for a clean start. See usage below for more information.</p>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">¤</a></h2>
<p>If you set up the registry with a <strong>loadbalancer</strong> service you will be able to push to the registry via the cluster's hostname, but before you can use the registry you will need to install the registry's CA certificate and restart the Docker daemon so that your client trusts the new registry:</p>
<pre><code class="language-bash">CACERT=$(oc -n airgap-registry get secret airgap-registry-certificate -o jsonpath='{.data.ca\.crt}' | base64 -d)
DOMAIN=$(oc get ingress.config cluster -o jsonpath='{.spec.domain}')
sudo mkdir -p /etc/docker/certs.d/$DOMAIN\:32500/
sudo echo &quot;$CACERT&quot; &gt; /etc/docker/certs.d/$DOMAIN\:32500/ca.crt
sudo service docker restart
</code></pre>
<p>You can now use the registry as normal:</p>
<pre><code class="language-bash">DOMAIN=$(oc get ingress.config cluster -o jsonpath='{.spec.domain}')
docker pull registry.access.redhat.com/ubi8/ubi-minimal
docker tag registry.access.redhat.com/ubi8/ubi-minimal $DOMAIN:32500/ubi8/ubi-minimal
docker push $DOMAIN:32500/ubi8/ubi-minimal
</code></pre>
<p>If you set up the registry with a <strong>clusterip</strong> service you will only be able to push to the registry after using port forwarding:</p>
<pre><code class="language-bash">oc -n airgap-registry port-forward deployment/airgap-registry 9000:5000

docker pull registry.access.redhat.com/ubi8/ubi-minimal
docker tag registry.access.redhat.com/ubi8/ubi-minimal localhost:9000/ubi8/ubi-minimal
docker push localhost:9000/ubi8/ubi-minimal
</code></pre>
<p>However, you will still need to set up Docker trust for the "local" registry:</p>
<pre><code class="language-bash">CACERT=$(oc -n airgap-registry get secret airgap-registry-certificate -o jsonpath='{.data.ca\.crt}' | base64 -d)
sudo mkdir -p /etc/docker/certs.d/$DOMAIN\:32500/
sudo mkdir /etc/docker/certs.d/localhost\:9000
sudo echo &quot;$CACERT&quot; &gt; /etc/docker/certs.d/localhost\:9000/ca.crt
sudo service docker restart
</code></pre>
<h2 id="usage-for-tear-down-action">Usage for tear-down action<a class="headerlink" href="#usage-for-tear-down-action" title="Permanent link">¤</a></h2>
<p>This role can also be used to permanently delete a mirror registry from a given cluster by setting the <code>registry_action</code> to <code>tear-down</code> and specifying the corresponding <code>registry_namespace</code>, if not using the default value.</p>
<p>Note that the tear-down action deletes the registry completely including the PVC storage and the registry namespace. To start up the registry again, the role needs to be run again with the registry_action on default or <code>setup</code>. Images previously stored in the registry before the tear-down will no longer be available and will need to be mirrored again once the registry setup has completed. Take precaution when using this function and expect that images can no longer be accessed from the registry that has been torn down.</p>
<p><strong>Note:</strong> Recreating the registry will also create a new ca cert for the new registry.</p>
<p>An appropriate time to use this tear-down function is when the registry has too many images that are not being used or when there has been a shift to support newer versions but images of older versions are clogging the registry. The tear-down function frees the disk space and allows for a new registry to be setup.</p>
<h2 id="role-variables">Role Variables<a class="headerlink" href="#role-variables" title="Permanent link">¤</a></h2>
<h3 id="registry_action">registry_action<a class="headerlink" href="#registry_action" title="Permanent link">¤</a></h3>
<p>The action to perform with this role. Can be set to <code>tear-down</code> to remove an existing registry and its namespace. Default is <code>setup</code></p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>REGISTRY_ACTION</code></li>
<li>Default Value: <code>setup</code></li>
</ul>
<h3 id="registry_namespace">registry_namespace<a class="headerlink" href="#registry_namespace" title="Permanent link">¤</a></h3>
<p>The namespace where the registry to run</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>REGISTRY_NAMESPACE</code></li>
<li>Default Value: <code>airgap-registry</code></li>
</ul>
<h3 id="registry_storage_class">registry_storage_class<a class="headerlink" href="#registry_storage_class" title="Permanent link">¤</a></h3>
<p><strong>Required</strong>:  The name of the storage class to configure the MongoDb operator to use for persistent storage in the MongoDb cluster. Storage class must support ReadWriteOnce(RWO) access mode.</p>
<ul>
<li><strong>Required</strong>, unless running in IBM Cloud ROKS, where the storage class will default to <code>ibmc-block-gold</code>.</li>
<li>Environment Variable: <code>REGISTRY_STORAGE_CLASS</code></li>
<li>Default Value: None</li>
</ul>
<h3 id="registry_storage_capacity">registry_storage_capacity<a class="headerlink" href="#registry_storage_capacity" title="Permanent link">¤</a></h3>
<p>The size of the PVC that will be created for data storage in the cluster.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>REGISTRY_STORAGE_CAPACITY</code></li>
<li>Default Value: <code>100Gi</code></li>
</ul>
<h3 id="registry_service_type">registry_service_type<a class="headerlink" href="#registry_service_type" title="Permanent link">¤</a></h3>
<p>The type of service to set up in front of the registry, either <code>loadbalancer</code> or <code>clusterip</code>.  Using <code>loadbalancer</code> will allow you to access the registry from outside of your cluster via the cluster domain on port <code>32500</code>.  If you have other loadbalancers on the cluster that already claim port <code>32500</code> this role can not be usedbecause currently the loadbalancer port can not be customised.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>REGISTRY_SERVICE_TYPE</code></li>
<li>Default Value: <code>loadbalancer</code></li>
</ul>
<h2 id="example-playbook">Example Playbook<a class="headerlink" href="#example-playbook" title="Permanent link">¤</a></h2>
<pre><code class="language-yaml">- hosts: localhost
  any_errors_fatal: true
  vars:
    registry_storage_class: ibmc-block-gold
    registry_storage_capacity: 500Gb
    registry_service_type: loadbalancer
  roles:
    - ibm.mas_devops.registry
</code></pre>
<h2 id="license">License<a class="headerlink" href="#license" title="Permanent link">¤</a></h2>
<p>EPL-2.0</p>
      
    </div>
    <!-- <div id="footer" class="rst-content">
      Built with mkdocs v1.6.1 (2025-07-02 06:50:00.831501+00:00)
    </div> -->
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": false, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
</script></body>
</html>