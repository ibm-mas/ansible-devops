<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>suite_dns - MAS DevOps Ansible Collection</title>

    <!-- Pure CSS (https://pure-css.github.io/) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css" integrity="sha384-X38yfunGUhNzHpBaEBsWLO+A0HDYOQi8ufWDkZ0k9e0eXz/tH3II7uKZ9msv++Ls" crossorigin="anonymous">
    <link rel="stylesheet" href="../../css/theme.css">

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha256-3edrmyuQ0w65f8gfBsqowzjJe2iM6n0nKciPUp8y+7E=" crossorigin="anonymous"></script>
    <script src="../../js/theme.js"></script>

    <!-- Carbon theme zones (white, g10, g90, g100) -->
    <link rel="stylesheet" href="https://1.www.s81c.com/common/carbon/web-components/tag/latest/themes.css">

    <!-- The Carbon web-components/framework -->
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/ui-shell.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/accordion.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/breadcrumb.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/select.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/tabs.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/search.min.js"></script>

    <!-- HighlightJS code formatting support -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
    <script>hljs.highlightAll();</script>

    <!-- Required by MkDocs search -->
    <script>var base_url = "../..";</script>

    <!-- User defined extras -->
    
    

    

    
    <script src="../../search/main.js"></script>
    
  <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: black; }
        </style></head>

  <body>
    <cds-header aria-label="MAS DevOps Ansible Collection" class="cds-theme-zone-g100">
      <cds-header-menu-button button-label-active="Close menu" button-label-inactive="Open menu"></cds-header-menu-button>
      <cds-header-name href="../.." prefix="IBM">MAS DevOps Ansible Collection</cds-header-name>
      <cds-header-nav menu-bar-label="IBM MAS DevOps Ansible Collection">
          <cds-header-nav-item is-active target="" href="">Ansible</cds-header-nav-item>
          <cds-header-nav-item target="" href="https://ibm-mas.github.io/cli/">CLI</cds-header-nav-item>
      </cds-header-nav>

      <div class="cds--header__global">
        <cds-search id="header-search" label-text="Search" cds-search-input="search-event" expandable></cds-search>
      </div>
      <script>
        var el = document.getElementById("header-search");
        el.addEventListener("cds-search-input", function (ev) {
          console.info(ev.detail.value)
          document.getElementById("header-search-value").setAttribute("value", ev.detail.value);
        });
        el.addEventListener('keydown', function (ev) {
          if (ev.key === 'Enter') {
            location.href="../../search.html?q=" + document.querySelector("#header-search").shadowRoot.querySelector("#input").value;
          }
        });
      </script>

      
        <cds-header-nav>
          <cds-header-nav-item href="https://github.com/ibm-mas/ansible-devops/blob/master/docs/roles/suite_dns.md">Edit on GitHub</cds-header-nav-item>
        </cds-header-nav>
      

    </cds-header>

    <cds-side-nav aria-label="Side navigation" class="cds-theme-zone-g90">
      <cds-side-nav-items>
        
          
  <cds-side-nav-menu title="General Information">
    
      
  <cds-side-nav-menu-item href="../..">
    Home
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../execution-environment/">
    Ansible Automation Platform
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Playbooks">
    
      
  <cds-side-nav-menu-item href="../../playbooks/ocp/">
    OCP
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/cp4d/">
    Install Cloud Pak For Data
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/aiservice/">
    Install AI Service
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/mas-core/">
    Install Core
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/mas-iot/">
    Add IoT
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/mas-manage/">
    Add Manage
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/mas-monitor/">
    Add Monitor
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/mas-optimizer/">
    Add Optimizer
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/mas-predict/">
    Add Predict
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/mas-visualinspection/">
    Add Visual Inspection
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/mas-facilities/">
    Add Real Estate and Facilities
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/mas-update/">
    Update
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/mas-upgrade/">
    Upgrade
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../../playbooks/backup-restore/">
    Backup &amp; Restore
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Roles: OCP Mgmt">
    
      
  <cds-side-nav-menu-item href="../ocp_cluster_monitoring/">
    ocp_cluster_monitoring
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_config/">
    ocp_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_deprovision/">
    ocp_deprovision
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_efs/">
    ocp_efs
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_github_oauth/">
    ocp_github_oauth
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_login/">
    ocp_login
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_node_config/">
    ocp_node_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_provision/">
    ocp_provision
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_roks_upgrade_registry_storage/">
    ocp_roks_upgrade_registry_storage
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_upgrade/">
    ocp_upgrade
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_verify/">
    ocp_verify
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Roles: Dependency Mgmt">
    
      
  <cds-side-nav-menu-item href="../appconnect/">
    appconnect
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../aws_bucket_access_point/">
    aws_bucket_access_point
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../aws_documentdb_user/">
    aws_documentdb_user
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../aws_policy/">
    aws_policy
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../aws_route53/">
    aws_route53
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../aws_user_creation/">
    aws_user_creation
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../aws_vpc/">
    aws_vpc
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../cert_manager/">
    cert_manager
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../cis/">
    cis
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../common_services/">
    common-services
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../configure_manage_eventstreams/">
    configure_manage_eventstreams
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../cos/">
    cos
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../cos_bucket/">
    cos_bucket
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../cp4d_admin_pwd_update/">
    cp4d_admin_pwd_update
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../cp4d/">
    cp4d
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../cp4d_service/">
    cp4d_service
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../db2/">
    db2
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../dro/">
    dro
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../eck/">
    eck
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../grafana/">
    grafana
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ibm_catalogs/">
    ibm_catalogs
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../kafka/">
    kafka
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../nvidia_gpu/">
    nvidia_gpu
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../mongodb/">
    mongodb
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocs/">
    ocs
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../sls/">
    sls
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../turbonomic/">
    turbonomic
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../uds/">
    uds
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Roles: Image Mirroring">
    
      
  <cds-side-nav-menu-item href="../mirror_case_prepare/">
    mirror_case_prepare
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../mirror_extras_prepare/">
    mirror_extras_prepare
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../mirror_images/">
    mirror_images
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../mirror_ocp/">
    mirror_ocp
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_idms/">
    ocp_idms
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../ocp_simulate_disconnected_network/">
    ocp_simulate_disconnected_network
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../registry/">
    registry
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Roles: Suite Mgmt" active expanded>
    
      
  <cds-side-nav-menu-item href="../suite_app_config/">
    suite_app_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_app_install/">
    suite_app_install
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_app_uninstall/">
    suite_app_uninstall
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_app_upgrade/">
    suite_app_upgrade
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_app_rollback/">
    suite_app_rollback
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_app_backup_restore/">
    suite_app_backup_restore
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_certs/">
    suite_certs
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_config/">
    suite_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_db2_setup_for_manage/">
    suite_db2_setup_for_manage
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="./" active expanded>
    suite_dns
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_install/">
    suite_install
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_attachments_config/">
    suite_manage_attachments_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_birt_report_config/">
    suite_manage_birt_report_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_bim_config/">
    suite_manage_bim_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_customer_files_config/">
    suite_manage_customer_files_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_imagestitching_config/">
    suite_manage_imagestitching_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_import_certs_config/">
    suite_manage_import_certs_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_load_dbc_scripts/">
    suite_manage_load_dbc_scripts
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_logging_config/">
    suite_manage_logging_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_manage_pvc_config/">
    suite_manage_pvc_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_uninstall/">
    suite_uninstall
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_upgrade/">
    suite_upgrade
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_rollback/">
    suite_rollback
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_verify/">
    suite_verify
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../suite_backup_restore/">
    suite_backup_restore
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Roles: Utilities">
    
      
  <cds-side-nav-menu-item href="../ansible_version_check/">
    ansible_version_check
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../entitlement_key_rotation/">
    entitlement_key_rotation
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../gencfg_jdbc/">
    gencfg_jdbc
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../gencfg_watsonstudio/">
    gencfg_watsonstudio
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../gencfg_workspace/">
    gencfg_workspace
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../gencfg_mongo/">
    gencfg_mongo
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
      </cds-side-nav-items>
    </cds-side-nav>

    <div id="breadcrumbs" class="rst-content"><cds-breadcrumb no-trailing-slash>
  <cds-breadcrumb-item>
    <cds-breadcrumb-link href="../..">Home</cds-breadcrumb-link>
  </cds-breadcrumb-item>
      <cds-breadcrumb-item>Roles: Suite Mgmt</cds-breadcrumb-item>

  <cds-breadcrumb-item aria-current="page">
    <cds-breadcrumb-link href="#suite_dns">suite_dns</cds-breadcrumb-link>
  </cds-breadcrumb-item>

  <cds-breadcrumb-item>
    <cds-select id="breadcrumbs-toc" class="cds-theme-zone-g10" inline placeholder="..." oninput="changeAnchor(this.value)">
    
    
      <cds-select-item value="#dns-management">DNS management</cds-select-item>
    
      <cds-select-item value="#lets-encrypt-integration">Let's Encrypt Integration</cds-select-item>
    
      <cds-select-item value="#role-variables-general">Role Variables - General</cds-select-item>
    
      <cds-select-item value="#role-variables-cloudflare-dns-integration">Role Variables - Cloudflare DNS Integration</cds-select-item>
    
      <cds-select-item value="#role-variables-ibm-cloud-internet-services-dns-integration">Role Variables - IBM Cloud Internet Services DNS Integration</cds-select-item>
    
      <cds-select-item value="#role-variables-enhanced-ibm-cis-dns-integration-secruity">Role Variables - Enhanced IBM CIS DNS Integration Secruity</cds-select-item>
    
      <cds-select-item value="#role-variables-aws-route-53">Role Variables - AWS Route 53</cds-select-item>
    
      <cds-select-item value="#prerequisites">Prerequisites</cds-select-item>
    
      <cds-select-item value="#role-variables-cloudpak-for-data">Role Variables - CloudPak for Data</cds-select-item>
    
      <cds-select-item value="#example-playbook-cis-or-cloudflare">Example Playbook - CIS or Cloudflare</cds-select-item>
    
      <cds-select-item value="#example-playbook-aws-route-53">Example Playbook - AWS Route 53</cds-select-item>
    
      <cds-select-item value="#license">License</cds-select-item>
    
  </cds-select>
  </cds-breadcrumb-item>
</cds-breadcrumb>
    </div>

    <div id="main-content" class="rst-content">
      
      <h1 id="suite_dns">suite_dns<a class="headerlink" href="#suite_dns" title="Permanent link">¤</a></h1>
<p>This role will manage MAS and DNS provider integration.  IBM Cloud Internet Services is the only supported DNS provider currently. It will also create a secure route (https://cp4d.<mas_domain>) to the CP4D web client using the custom domain used in this role.</mas_domain></p>
<p><strong>Note</strong>: this role will take no action when <code>mas_manual_cert_mgmt</code>is set to <code>True</code></p>
<h2 id="dns-management">DNS management<a class="headerlink" href="#dns-management" title="Permanent link">¤</a></h2>
<p>There are two different ways this role controls DNS entries in the provider:</p>
<h3 id="top-level-dns-entries">Top Level DNS entries<a class="headerlink" href="#top-level-dns-entries" title="Permanent link">¤</a></h3>
<p>This mode will create the entries directly under your DNS zone. Use this when the DNS zone matches the MAS domain exactly.  If your MAS installation will be using the domain <strong>mymas.mycompany.com</strong> and you have a DNS zone for <strong>mymas.mycompany.com</strong> then you will be creating top-level DNS entries for MAS, e.g. <strong>admin</strong>, <strong>home</strong>, &amp; <strong>api</strong>.</p>
<h3 id="subdomain-dns-entries">Subdomain DNS entries<a class="headerlink" href="#subdomain-dns-entries" title="Permanent link">¤</a></h3>
<p>This mode will create DNS entries in the zone under a subdomain. Use this when your DNS zone will be used for more than just one MAS instance. If your MAS installation will be using the domain <strong>mymas.mycompany.com</strong> and you have a DNS zone for <strong>mycompany.com</strong> then you will be creating subdomain DNS entries for MAS, e.g. <strong>admin.mymas</strong>, <strong>home.mymas</strong>, &amp; <strong>api.mymas</strong>.</p>
<p>CIS and Cloudflare integrations support both mode of DNS management. A single optional variable is required to enable subdomain DNS management, in the examples above you would set these to <strong>mymas</strong>:</p>
<ul>
<li><a href="#cis_subdomain">cis_subdomain</a></li>
<li><a href="#cloudflare_subdomain">cloudflare_subdomain</a></li>
</ul>
<h2 id="lets-encrypt-integration">Let's Encrypt Integration<a class="headerlink" href="#lets-encrypt-integration" title="Permanent link">¤</a></h2>
<p>Both the CIS and Cloudflare options also enable integration with <a href="https://letsencrypt.org/">Let's Encrypt</a> for automatic certificate management via IBM Certificate Manager.  Each will create a new <a href="https://cert-manager.io/docs/reference/api-docs/#cert-manager.io/v1.ClusterIssuer">ClusterIssuer</a> which can be used when installing Maximo Application Suite:</p>
<ul>
<li>Cloudflare Let's Encrypt ClusterIssuer: <code>{{ mas_instance_id }}-cloudflare-le-prod</code></li>
<li>IBM Cloud Internet Services Let's Encrypt ClusterIssuer: <code>{{ mas_instance_id }}-cis-le-prod</code></li>
</ul>
<p>If you want to use Let's Encrypt certificates in your MAS installation you will need to configure the <code>mas_cluster_issuer</code> variable in the <a href="../suite_install/">suite_install</a> role, setting it to the name of the ClusterIssuer as documented above.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are issues with how cert-manager works with LetsEncrypt staging servers. It creates a secret for the certificate that doesn't contain the LetsEncrypt CA, but the staging service does not use a well known cert so we end up with MAS unable to trust the certificates generated by LetsEncrypt staging.</p>
<p>At present there is no workaround for this, so do not use the LetsEncrypt staging certificate issuer.</p>
</div>
<h2 id="role-variables-general">Role Variables - General<a class="headerlink" href="#role-variables-general" title="Permanent link">¤</a></h2>
<h3 id="dns_provider">dns_provider<a class="headerlink" href="#dns_provider" title="Permanent link">¤</a></h3>
<ul>
<li><strong>Required</strong></li>
<li>Environment Variable: <code>DNS_PROVIDER</code></li>
<li>Default: None</li>
</ul>
<h3 id="mas_instance_id">mas_instance_id:<a class="headerlink" href="#mas_instance_id" title="Permanent link">¤</a></h3>
<ul>
<li><strong>Required</strong></li>
<li>Environment Variable: <code>MAS_INSTANCE_ID</code></li>
<li>Default: None</li>
</ul>
<h3 id="mas_workspace_id">mas_workspace_id:<a class="headerlink" href="#mas_workspace_id" title="Permanent link">¤</a></h3>
<ul>
<li><strong>Required</strong></li>
<li>Environment Variable: <code>MAS_WORKSPACE_ID</code></li>
<li>Default: None</li>
</ul>
<h3 id="mas_domain">mas_domain<a class="headerlink" href="#mas_domain" title="Permanent link">¤</a></h3>
<ul>
<li><strong>Required</strong></li>
<li>Environment Variable: <code>MAS_DOMAIN</code></li>
<li>Default: None</li>
</ul>
<h3 id="ocp_ingress">ocp_ingress<a class="headerlink" href="#ocp_ingress" title="Permanent link">¤</a></h3>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>OCP_INGRESS</code></li>
<li>Default: None</li>
</ul>
<h3 id="cert_manager_namespace">cert_manager_namespace<a class="headerlink" href="#cert_manager_namespace" title="Permanent link">¤</a></h3>
<p>Namespace where Certificate Manager is installed.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>CERT_MANAGER_NAMESPACE</code></li>
<li>Default: None</li>
</ul>
<h3 id="custom_labels">custom_labels<a class="headerlink" href="#custom_labels" title="Permanent link">¤</a></h3>
<p>List of comma separated key=value pairs for setting custom labels on instance specific resources.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>CUSTOM_LABELS</code></li>
<li>Default: None</li>
</ul>
<h2 id="role-variables-cloudflare-dns-integration">Role Variables - Cloudflare DNS Integration<a class="headerlink" href="#role-variables-cloudflare-dns-integration" title="Permanent link">¤</a></h2>
<h3 id="cloudflare_email">cloudflare_email<a class="headerlink" href="#cloudflare_email" title="Permanent link">¤</a></h3>
<ul>
<li><strong>Required</strong> if <code>dns_provider</code> is set to <code>cloudflare</code></li>
<li>Environment Variable: <code>CLOUDFLARE_EMAIL</code></li>
<li>Default: None</li>
</ul>
<h3 id="cloudflare_apitoken">cloudflare_apitoken<a class="headerlink" href="#cloudflare_apitoken" title="Permanent link">¤</a></h3>
<p>To generate an API token follow the <a href="https://developers.cloudflare.com/fundamentals/api/get-started/create-token/">Cloudflare documentation</a>.</p>
<ul>
<li><strong>Required</strong> if <code>dns_provider</code> is set to <code>cloudflare</code></li>
<li>Environment Variable: <code>CLOUDFLARE_APITOKEN</code></li>
<li>Default: None</li>
</ul>
<h3 id="cloudflare_zone">cloudflare_zone<a class="headerlink" href="#cloudflare_zone" title="Permanent link">¤</a></h3>
<p>This is your domain name that is managed by Cloudflare (e.g. <code>mydomain.com</code>).</p>
<ul>
<li><strong>Required</strong> if <code>dns_provider</code> is set to <code>cloudflare</code></li>
<li>Environment Variable: <code>CLOUDFLARE_ZONE</code></li>
<li>Default: None</li>
</ul>
<h3 id="cloudflare_subdomain">cloudflare_subdomain<a class="headerlink" href="#cloudflare_subdomain" title="Permanent link">¤</a></h3>
<p>Set this to the name of the subdomain under your Cloudflare domain where you would like to manage the MAS DNS entires if you don't want MAS to use the top-level domain itself.  In other words <code>cloudflare_subdomain.cloudflare_zone</code> should equal <code>mas_domain</code>.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>CLOUDFLARE_SUBDOMAIN</code></li>
<li>Default: None</li>
</ul>
<h2 id="role-variables-ibm-cloud-internet-services-dns-integration">Role Variables - IBM Cloud Internet Services DNS Integration<a class="headerlink" href="#role-variables-ibm-cloud-internet-services-dns-integration" title="Permanent link">¤</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
</div>
<p>When using CIS integration, some resources will be installed in the cluster such as RBACs, API Services and CIS Webhook deployments.
  In OCP 4.12+, to avoid CIS webhook deployment failure at start up, this role will grant <code>anyuid</code> permission to <code>cert-manager-webhook-ibm-cis</code> service account so it can fully access the cert-manager-webhook-ibm-cis deployment pod as a workaround:
  <code>oc adm policy add-scc-to-user anyuid -z cert-manager-webhook-ibm-cis -n ibm-common-services</code></p>
<h3 id="cis_email">cis_email<a class="headerlink" href="#cis_email" title="Permanent link">¤</a></h3>
<ul>
<li><strong>Required</strong> if <code>dns_provider</code> is set to <code>cis</code>. This is the e-mail that will be used in the Cluster Issuer resource, created by this role, to connect with the certificate manager (i.e. Let's Encrypt).</li>
<li>Environment Variable: <code>CIS_EMAIL</code></li>
<li>Default: None</li>
</ul>
<h3 id="cis_apikey">cis_apikey<a class="headerlink" href="#cis_apikey" title="Permanent link">¤</a></h3>
<ul>
<li><strong>Required</strong> if <code>dns_provider</code> is set to <code>cis</code></li>
<li>Environment Variable: <code>CIS_APIKEY</code></li>
<li>Default: None</li>
</ul>
<h3 id="cis_crn">cis_crn<a class="headerlink" href="#cis_crn" title="Permanent link">¤</a></h3>
<ul>
<li><strong>Required</strong> if <code>dns_provider</code> is set to <code>cis</code></li>
<li>Environment Variable: <code>CIS_CRN</code></li>
<li>Default: None</li>
</ul>
<h3 id="cis_subdomain">cis_subdomain<a class="headerlink" href="#cis_subdomain" title="Permanent link">¤</a></h3>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>CIS_SUBDOMAIN</code></li>
<li>Default: None</li>
</ul>
<h3 id="cis_enhanced_security">cis_enhanced_security<a class="headerlink" href="#cis_enhanced_security" title="Permanent link">¤</a></h3>
<p>Set this to true to enable the enhanced IBM CIS DNS integration security - which includes:
- Enabling WAF firewall disabling rules that affect MAS application functionalities
- Enabling Proxy for DNS entries
- Using an expanded list of DNS entries
- Ensuring there are no wildcard DNS entry in CIS
- Creating Edge Certificates in CIS instance
See https://cloud.ibm.com/docs/cis?topic=cis-manage-your-ibm-cis-for-optimal-security for more details.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>CIS_ENHANCED_SECURITY</code></li>
<li>Default: false</li>
</ul>
<h2 id="role-variables-enhanced-ibm-cis-dns-integration-secruity">Role Variables - Enhanced IBM CIS DNS Integration Secruity<a class="headerlink" href="#role-variables-enhanced-ibm-cis-dns-integration-secruity" title="Permanent link">¤</a></h2>
<p>See the "cis_enhanced_security" variable above for details.</p>
<h3 id="cis_waf">cis_waf<a class="headerlink" href="#cis_waf" title="Permanent link">¤</a></h3>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>CIS_WAF</code></li>
<li>Default: true</li>
</ul>
<h3 id="cis_proxy">cis_proxy<a class="headerlink" href="#cis_proxy" title="Permanent link">¤</a></h3>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>CIS_PROXY</code></li>
<li>Default: false</li>
</ul>
<h3 id="cis_service_name">cis_service_name<a class="headerlink" href="#cis_service_name" title="Permanent link">¤</a></h3>
<p>Set this to override the default CIS service name that would otherwise be created as {ClusterName}-cis-{mas_instance_id} (where Cluster Name is derived automatically from the cluster)</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>CIS_SERVICE_NAME</code></li>
</ul>
<h3 id="update_dns">update_dns<a class="headerlink" href="#update_dns" title="Permanent link">¤</a></h3>
<p>Set this to false if you want to not update DNS entries if they already exist</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>UPDATE_DNS_ENTRIES</code></li>
<li>Default: true</li>
</ul>
<h3 id="delete_wildcards">delete_wildcards<a class="headerlink" href="#delete_wildcards" title="Permanent link">¤</a></h3>
<p>Set this to true to force deletion of wildcard dns entries in cis</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>DELETE_WILDCARDS</code></li>
<li>Default: false</li>
</ul>
<h3 id="override_edge_certs">override_edge_certs<a class="headerlink" href="#override_edge_certs" title="Permanent link">¤</a></h3>
<p>Set this to false to not override and delete any existing edge certificates in cis instance when creating new edge certificates</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>OVERRIDE_EDGE_CERTS</code></li>
<li>Default: true</li>
</ul>
<h3 id="output_dir">output_dir<a class="headerlink" href="#output_dir" title="Permanent link">¤</a></h3>
<p>Location to output the edge-routes-{mas_instance_id}.txt</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>OUTPUT_DIR</code></li>
<li>Default: <code>.</code> (which will set the directory file in ibm/mas_devops)</li>
</ul>
<h3 id="cis_entries_to_add">cis_entries_to_add<a class="headerlink" href="#cis_entries_to_add" title="Permanent link">¤</a></h3>
<p>Comma seperated list of entries to add for edge certificates. These are broken down into functional areas of MAS. The options are:</p>
<ul>
<li><code>all</code> to include all entries (this is the default behaviour)</li>
<li><code>core</code> to include the MAS Core edge certificates</li>
<li><code>health</code> to include the MAS Health App edge certificates</li>
<li><code>iot</code> to include the MAS IoT app edge certificates</li>
<li><code>manage</code> to include the MAS Manage app edge certificates</li>
<li><code>monitor</code> to include the MAS Monitor app edge certificates</li>
<li><code>predict</code> to include the MAS Predict app edge certificates</li>
<li><code>visualinspection</code> to include the MAS VisualInspection app edge certificates</li>
<li><code>optimizer</code> to include the MAS Optimizer app edge certificates</li>
<li><code>assist</code> to include the MAS Assist app edge certificates</li>
<li><code>arcgis</code> to include the MAS Arcgis edge certificates</li>
<li><code>reportdb</code> to include the MAS ReportDB edge certificates</li>
<li>
<p><code>facilities</code> to include the MAS Facilities app edge certificates</p>
</li>
<li>
<p>Optional</p>
</li>
<li>Environment Variable: <code>CIS_ENTRIES_TO_ADD</code></li>
<li>Default: <code>all</code></li>
</ul>
<h2 id="role-variables-aws-route-53">Role Variables - AWS Route 53<a class="headerlink" href="#role-variables-aws-route-53" title="Permanent link">¤</a></h2>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">¤</a></h2>
<p>To run this role successfully you must have already installed the <a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html">AWS CLI</a>.
Also, you need to have AWS user credentials configured via <code>aws configure</code> command or simply export <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code> environment variables with your corresponding AWS username credentials prior running this role.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In some cases, the Route 53 zone may not resolve the certificate challenges generated by IBM Certificate Manager, which could cause a problem while issuing the public certificates via Let's Encrypt. In this case, a manual workaround might be needed in cert-manager-controller pod to enable recursive nameservers.</p>
<p>For more details on how to apply this workaround, refer to <a href="https://community.ibm.com/community/user/asset-facilities/blogs/brian-zhu/2022/10/08/using-lets-encrypt-ssl-certificates-with-maximo-ap?CommunityKey=3d7261ae-48f7-481d-b675-a40eb407e0fd">this documentation</a>.</p>
<p>This workaround is not automated, as most of the times this is not needed, but when it is, it requires the <code>cert-manager-controller</code> pod to be stopped, thus we want to avoid making this behavior as standard approach.</p>
</div>
<h3 id="route53_hosted_zone_name">route53_hosted_zone_name<a class="headerlink" href="#route53_hosted_zone_name" title="Permanent link">¤</a></h3>
<p>AWS Route53 Hosted Zone name.</p>
<ul>
<li>Required.</li>
<li>Environment Variable: <code>ROUTE53_HOSTED_ZONE_NAME</code></li>
<li>Default Value: None</li>
</ul>
<h3 id="route53_hosted_zone_region">route53_hosted_zone_region<a class="headerlink" href="#route53_hosted_zone_region" title="Permanent link">¤</a></h3>
<p>AWS Route53 Hosted Zone region.</p>
<ul>
<li>Required.</li>
<li>Environment Variable: <code>ROUTE53_HOSTED_ZONE_REGION</code></li>
<li>Default Value: Same value as defined in <code>AWS_REGION</code>, or if none defined, then <code>us-east-2</code> is the defaulted region.</li>
</ul>
<h3 id="route53_subdomain">route53_subdomain<a class="headerlink" href="#route53_subdomain" title="Permanent link">¤</a></h3>
<p>If a subdomain is defined, this will be used to create the corresponding CNAME entries in the targeted Route53 hosted zone instance.
Therefore, the Route53 subdomain + the Route53 hosted zone name defined, when combined, needs to match with the chosen MAS Domain, otherwise the DNS records won't be able to get resolved.</p>
<pre><code>Example:
MAS Top Level Domain: my-mas-instance.mycompany.com
AWS Route53 hosted zone name: mycompany.com
AWS Route53 subdomain: my-mas-instance
</code></pre>
<ul>
<li>Optional.</li>
<li>Environment Variable: <code>ROUTE53_SUBDOMAIN</code></li>
<li>Default Value: None</li>
</ul>
<h3 id="route53_email">route53_email<a class="headerlink" href="#route53_email" title="Permanent link">¤</a></h3>
<p>AWS Route53 contact e-mail. Will be set in the cluster issuer created in order to receive alerts.</p>
<ul>
<li>Optional.</li>
<li>Environment Variable: <code>ROUTE53_EMAIL</code></li>
<li>Default Value: None.</li>
</ul>
<h2 id="role-variables-cloudpak-for-data">Role Variables - CloudPak for Data<a class="headerlink" href="#role-variables-cloudpak-for-data" title="Permanent link">¤</a></h2>
<h3 id="cpd_instance_namespace">cpd_instance_namespace<a class="headerlink" href="#cpd_instance_namespace" title="Permanent link">¤</a></h3>
<p>Namespace where the Cloud Pak for Data is installed and the <code>cpd</code> route exists.
If set, then this role will also attempt to configure public certificates to the CPD route using the DNS provider defined.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>CPD_INSTANCE_NAMESPACE</code></li>
<li>Default Value: None.</li>
</ul>
<h3 id="cpd_prod_issuer_name">cpd_prod_issuer_name<a class="headerlink" href="#cpd_prod_issuer_name" title="Permanent link">¤</a></h3>
<p>Define the certificate issuer responsible for generating the public certificate for your CPD route.
If not set, then it will use same issuer set for MAS instance.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>CPD_PROD_ISSUER_NAME</code></li>
<li>Default Value: Same certificate issuer used for MAS instance.</li>
</ul>
<h3 id="cpd_custom_domain">cpd_custom_domain<a class="headerlink" href="#cpd_custom_domain" title="Permanent link">¤</a></h3>
<p>Define the custom domain for your CPD route.
If not set, then it will use same domain set for MAS instance.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>CPD_CUSTOM_DOMAIN</code></li>
<li>Default Value: <code>cp4d.{{ mas_domain }}</code>.</li>
</ul>
<h2 id="example-playbook-cis-or-cloudflare">Example Playbook - CIS or Cloudflare<a class="headerlink" href="#example-playbook-cis-or-cloudflare" title="Permanent link">¤</a></h2>
<pre><code class="language-yaml">---
- hosts: localhost
  any_errors_fatal: true
  vars:
    dns_provider: cis OR cloudflare
    mas_instance_id: inst1
    mas_domain: mydomain.com
    cis_crn: xxx
    cis_apikey: xxx
    cis_email: xxx
  roles:
    - ibm.mas_devops.suite_dns
</code></pre>
<h2 id="example-playbook-aws-route-53">Example Playbook - AWS Route 53<a class="headerlink" href="#example-playbook-aws-route-53" title="Permanent link">¤</a></h2>
<pre><code class="language-yaml">---
- hosts: localhost
  any_errors_fatal: true
  vars:
    dns_provider: route53
    mas_instance_id: inst1
    mas_domain: inst1.mydomain.com
    aws_access_key_id: xxx
    aws_secret_access_key: xxx
    route53_hosted_zone_name: mydomain.com
    route53_hosted_zone_region: us-east-2
    route53_subdomain: inst1
    route53_email: anyemail@test.com
  roles:
    - ibm.mas_devops.suite_dns
</code></pre>
<h2 id="license">License<a class="headerlink" href="#license" title="Permanent link">¤</a></h2>
<p>EPL-2.0</p>
      
    </div>
    <!-- <div id="footer" class="rst-content">
      Built with mkdocs v1.6.1 (2025-10-15 13:31:45.778878+00:00)
    </div> -->
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": false, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
</script></body></html>