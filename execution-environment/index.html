<!DOCTYPE html><html><head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Ansible Automation Platform - MAS DevOps Ansible Collection</title>

    <!-- Pure CSS (https://pure-css.github.io/) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css" integrity="sha384-X38yfunGUhNzHpBaEBsWLO+A0HDYOQi8ufWDkZ0k9e0eXz/tH3II7uKZ9msv++Ls" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/theme.css">

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha256-3edrmyuQ0w65f8gfBsqowzjJe2iM6n0nKciPUp8y+7E=" crossorigin="anonymous"></script>
    <script src="../js/theme.js"></script>

    <!-- Carbon theme zones (white, g10, g90, g100) -->
    <link rel="stylesheet" href="https://1.www.s81c.com/common/carbon/web-components/tag/latest/themes.css">

    <!-- The Carbon web-components/framework -->
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/ui-shell.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/accordion.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/breadcrumb.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/select.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/tabs.min.js"></script>
    <script type="module" src="https://1.www.s81c.com/common/carbon/web-components/version/v2.15.0/search.min.js"></script>

    <!-- HighlightJS code formatting support -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
    <script>hljs.highlightAll();</script>

    <!-- Required by MkDocs search -->
    <script>var base_url = "..";</script>

    <!-- User defined extras -->
    
    

    

    
    <script src="../search/main.js"></script>
    
  <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: black; }
        </style></head>

  <body>
    <cds-header aria-label="MAS DevOps Ansible Collection" class="cds-theme-zone-g100">
      <cds-header-menu-button button-label-active="Close menu" button-label-inactive="Open menu"></cds-header-menu-button>
      <cds-header-name href=".." prefix="IBM">MAS DevOps Ansible Collection</cds-header-name>
      <cds-header-nav menu-bar-label="IBM MAS DevOps Ansible Collection">
          <cds-header-nav-item is-active target="" href="">Ansible</cds-header-nav-item>
          <cds-header-nav-item target="" href="https://ibm-mas.github.io/cli/">CLI</cds-header-nav-item>
      </cds-header-nav>

      <div class="cds--header__global">
        <cds-search id="header-search" label-text="Search" cds-search-input="search-event" expandable></cds-search>
      </div>
      <script>
        var el = document.getElementById("header-search");
        el.addEventListener("cds-search-input", function (ev) {
          console.info(ev.detail.value)
          document.getElementById("header-search-value").setAttribute("value", ev.detail.value);
        });
        el.addEventListener('keydown', function (ev) {
          if (ev.key === 'Enter') {
            location.href="../search.html?q=" + document.querySelector("#header-search").shadowRoot.querySelector("#input").value;
          }
        });
      </script>

      
        <cds-header-nav>
          <cds-header-nav-item href="https://github.com/ibm-mas/ansible-devops/blob/master/docs/execution-environment.md">Edit on GitHub</cds-header-nav-item>
        </cds-header-nav>
      

    </cds-header>

    <cds-side-nav aria-label="Side navigation" class="cds-theme-zone-g90">
      <cds-side-nav-items>
        
          
  <cds-side-nav-menu title="General Information" active expanded>
    
      
  <cds-side-nav-menu-item href="..">
    Home
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="./" active expanded>
    Ansible Automation Platform
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Playbooks">
    
      
  <cds-side-nav-menu-item href="../playbooks/ocp/">
    OCP
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../playbooks/cp4d/">
    Install Cloud Pak For Data
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../playbooks/aiservice/">
    Install AI Service
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../playbooks/mas-core/">
    Install Core
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../playbooks/mas-iot/">
    Add IoT
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../playbooks/mas-manage/">
    Add Manage
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../playbooks/mas-monitor/">
    Add Monitor
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../playbooks/mas-optimizer/">
    Add Optimizer
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../playbooks/mas-predict/">
    Add Predict
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../playbooks/mas-visualinspection/">
    Add Visual Inspection
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../playbooks/mas-facilities/">
    Add Real Estate and Facilities
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../playbooks/mas-update/">
    Update
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../playbooks/mas-upgrade/">
    Upgrade
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../playbooks/backup-restore/">
    Backup &amp; Restore
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Roles: OCP Mgmt">
    
      
  <cds-side-nav-menu-item href="../roles/ocp_cluster_monitoring/">
    ocp_cluster_monitoring
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/ocp_config/">
    ocp_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/ocp_deprovision/">
    ocp_deprovision
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/ocp_efs/">
    ocp_efs
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/ocp_github_oauth/">
    ocp_github_oauth
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/ocp_login/">
    ocp_login
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/ocp_node_config/">
    ocp_node_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/ocp_provision/">
    ocp_provision
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/ocp_roks_upgrade_registry_storage/">
    ocp_roks_upgrade_registry_storage
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/ocp_upgrade/">
    ocp_upgrade
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/ocp_verify/">
    ocp_verify
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Roles: Dependency Mgmt">
    
      
  <cds-side-nav-menu-item href="../roles/appconnect/">
    appconnect
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/aws_bucket_access_point/">
    aws_bucket_access_point
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/aws_documentdb_user/">
    aws_documentdb_user
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/aws_policy/">
    aws_policy
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/aws_route53/">
    aws_route53
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/aws_user_creation/">
    aws_user_creation
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/aws_vpc/">
    aws_vpc
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/cert_manager/">
    cert_manager
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/cis/">
    cis
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/common_services/">
    common-services
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/configure_manage_eventstreams/">
    configure_manage_eventstreams
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/cos/">
    cos
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/cos_bucket/">
    cos_bucket
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/cp4d_admin_pwd_update/">
    cp4d_admin_pwd_update
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/cp4d/">
    cp4d
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/cp4d_service/">
    cp4d_service
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/db2/">
    db2
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/dro/">
    dro
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/eck/">
    eck
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/grafana/">
    grafana
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/ibm_catalogs/">
    ibm_catalogs
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/kafka/">
    kafka
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/nvidia_gpu/">
    nvidia_gpu
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/mongodb/">
    mongodb
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/ocs/">
    ocs
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/sls/">
    sls
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/turbonomic/">
    turbonomic
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/uds/">
    uds
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Roles: Image Mirroring">
    
      
  <cds-side-nav-menu-item href="../roles/mirror_case_prepare/">
    mirror_case_prepare
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/mirror_extras_prepare/">
    mirror_extras_prepare
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/mirror_images/">
    mirror_images
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/mirror_ocp/">
    mirror_ocp
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/ocp_idms/">
    ocp_idms
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/ocp_simulate_disconnected_network/">
    ocp_simulate_disconnected_network
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/registry/">
    registry
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Roles: Suite Mgmt">
    
      
  <cds-side-nav-menu-item href="../roles/suite_app_config/">
    suite_app_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_app_install/">
    suite_app_install
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_app_uninstall/">
    suite_app_uninstall
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_app_upgrade/">
    suite_app_upgrade
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_app_rollback/">
    suite_app_rollback
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_app_backup_restore/">
    suite_app_backup_restore
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_certs/">
    suite_certs
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_config/">
    suite_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_db2_setup_for_manage/">
    suite_db2_setup_for_manage
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_dns/">
    suite_dns
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_install/">
    suite_install
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_manage_attachments_config/">
    suite_manage_attachments_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_manage_birt_report_config/">
    suite_manage_birt_report_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_manage_bim_config/">
    suite_manage_bim_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_manage_customer_files_config/">
    suite_manage_customer_files_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_manage_imagestitching_config/">
    suite_manage_imagestitching_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_manage_import_certs_config/">
    suite_manage_import_certs_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_manage_load_dbc_scripts/">
    suite_manage_load_dbc_scripts
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_manage_logging_config/">
    suite_manage_logging_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_manage_pvc_config/">
    suite_manage_pvc_config
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_uninstall/">
    suite_uninstall
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_upgrade/">
    suite_upgrade
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_rollback/">
    suite_rollback
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_verify/">
    suite_verify
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/suite_backup_restore/">
    suite_backup_restore
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
          
  <cds-side-nav-menu title="Roles: Utilities">
    
      
  <cds-side-nav-menu-item href="../roles/ansible_version_check/">
    ansible_version_check
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/entitlement_key_rotation/">
    entitlement_key_rotation
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/gencfg_jdbc/">
    gencfg_jdbc
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/gencfg_watsonstudio/">
    gencfg_watsonstudio
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/gencfg_workspace/">
    gencfg_workspace
  </cds-side-nav-menu-item>

    
      
  <cds-side-nav-menu-item href="../roles/gencfg_mongo/">
    gencfg_mongo
  </cds-side-nav-menu-item>

    
  </cds-side-nav-menu>

        
      </cds-side-nav-items>
    </cds-side-nav>

    <div id="breadcrumbs" class="rst-content"><cds-breadcrumb no-trailing-slash>
  <cds-breadcrumb-item>
    <cds-breadcrumb-link href="..">Home</cds-breadcrumb-link>
  </cds-breadcrumb-item>
      <cds-breadcrumb-item>General Information</cds-breadcrumb-item>

  <cds-breadcrumb-item aria-current="page">
    <cds-breadcrumb-link href="#execution-environment">Execution Environment</cds-breadcrumb-link>
  </cds-breadcrumb-item>

  <cds-breadcrumb-item>
    <cds-select id="breadcrumbs-toc" class="cds-theme-zone-g10" inline placeholder="..." oninput="changeAnchor(this.value)">
    
    
      <cds-select-item value="#execution-environment-image">Execution Environment Image</cds-select-item>
    
      <cds-select-item value="#how-to-setup-anisble-automation-platform">How to setup Anisble Automation Platform</cds-select-item>
    
      <cds-select-item value="#how-to-run-a-job">How to run a Job</cds-select-item>
    
      <cds-select-item value="#examples-of-playbooks">Examples of playbooks</cds-select-item>
    
      <cds-select-item value="#troubleshooting">Troubleshooting</cds-select-item>
    
  </cds-select>
  </cds-breadcrumb-item>
</cds-breadcrumb>
    </div>

    <div id="main-content" class="rst-content">
      
      <h1 id="execution-environment">Execution Environment<a class="headerlink" href="#execution-environment" title="Permanent link">¤</a></h1>
<p>Details on the <a href="https://www.redhat.com/en/technologies/management/ansible">Red Hat Ansible Automation Platform</a> Execution Environment for the <strong>ibm.mas_devops</strong> Ansible Collection.</p>
<h2 id="execution-environment-image">Execution Environment Image<a class="headerlink" href="#execution-environment-image" title="Permanent link">¤</a></h2>
<p>The execution environment image for ansible-devops builds on the latest ansible-automation-platform-24/ee-supported-rhel9 image from Red Hat that provides the ansible-core and Red Hat supported collections. The ansible-devops-ee image includes the <code>ibm.mas_devops</code> collection and all required client libraries to function.</p>
<p>The image is uploaded to quay.io at <a href="https://quay.io/ibmmas/ansible-devops-ee">quay.io/ibmmas/ansible-devops-ee</a></p>
<h2 id="how-to-setup-anisble-automation-platform">How to setup Anisble Automation Platform<a class="headerlink" href="#how-to-setup-anisble-automation-platform" title="Permanent link">¤</a></h2>
<h3 id="organization">Organization<a class="headerlink" href="#organization" title="Permanent link">¤</a></h3>
<p>An Organization is a logical collection of Users, Teams, Projects, and Inventories, and is the highest level in the automation controller object hierarchy. Create an organization if you don't already have one:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/organization.png" data-title="org" data-desc-position="bottom"><img alt="org" src="../images/organization.png"></a></p>
<h3 id="inventory">Inventory<a class="headerlink" href="#inventory" title="Permanent link">¤</a></h3>
<p>An Inventory is a collection of hosts against which jobs may be launched, the same as an Ansible inventory file. The <code>ibm.mas_devops</code> collection runs against localhost so an Inventory of hosts just requires the one host of <code>localhost</code> to be added but this might be important for any other roles you might want to execute outside of this collection but within this organization. Create an initial inventory if one doesn't exist yet:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/inventory.png" data-title="Inventory" data-desc-position="bottom"><img alt="Inventory" src="../images/inventory.png"></a></p>
<p>Ensure that the host entry has the following variables set to ensure a local connection:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/inventory-2.png" data-title="Inventroy" data-desc-position="bottom"><img alt="Inventroy" src="../images/inventory-2.png"></a></p>
<h3 id="execution-environment_1">Execution Environment<a class="headerlink" href="#execution-environment_1" title="Permanent link">¤</a></h3>
<p>In Ansible Automation Platform (AAP) you can setup a new Execution Environment by specifying the image and tag. You can use either a versioned tag or latest such as <code>quay.io/ibmmas/ansible-devops-ee:latest</code> or <code>quay.io/ibmmas/ansible-devops-ee:24.0.0</code></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/execution-env.png" data-title="execution-env" data-desc-position="bottom"><img alt="execution-env" src="../images/execution-env.png"></a></p>
<h3 id="credentials">Credentials<a class="headerlink" href="#credentials" title="Permanent link">¤</a></h3>
<p>To use your own playbooks that are in source control management (SCM) you will need to setup credentials in AAP to fetch these (unless the repo is public). An example of this is providing a GitHub fine-grained access token which will just allow the token to read the contents of the repo.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/credentials.png" data-title="creds-1" data-desc-position="bottom"><img alt="creds-1" src="../images/credentials.png"></a></p>
<p>¡<a href="../images/credentials-2.png">creds-2</a></p>
<p>Depending on if you have an exiting cluster or not, then you will need to setup the <code>OpenShift or Kubernetes API Bearer Token</code> credentials to access the Openshift cluster, which will be required on any Jobs that interect with the cluster.</p>
<h3 id="project">Project<a class="headerlink" href="#project" title="Permanent link">¤</a></h3>
<p>Once you have the execution environment setup you can now create a Project that will point to the source of your playbooks. It is recommended that you use your own source of playbooks rather than the playbooks contained in this repo, to give you full control over what is run to suit your needs. Create the Project and set the Execution Environment to be the one created eariler, and set the source control details and credentials needed for AAP to read your playbooks.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/Project.png" data-title="project" data-desc-position="bottom"><img alt="project" src="../images/Project.png"></a></p>
<h3 id="job-templates">Job Templates<a class="headerlink" href="#job-templates" title="Permanent link">¤</a></h3>
<p>The Job Templates are what each Job is launched from and contains the details of what Playbook to execute. The Job is the executed instance of a Template that contains any specific values required.</p>
<p>To create the Template add the Inventory, Project and Execution Environment setup previously. The playbook dropdown should contain all the playbooks that are found in your SCM (if no playbooks are shown then check the <a href="#troubleshooting">Troubleshooting</a> section). At this point you can choose any other settings that you might want to use, and it is recommended to check the AAP <a href="https://docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/2.5">documentation</a> on this.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/template-1.png" data-title="template-1" data-desc-position="bottom"><img alt="template-1" src="../images/template-1.png"></a></p>
<p>Once the Job template is created then you can click on the created template and navigate to <code>Survey</code>. This is where you can provide any secure variables for your playbook that you don't want to keep in source control. You can choose the questions to ask and what type the variable should be. The variable name should make the variable name that the corresponding role is expecting.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/survey.png" data-title="survey" data-desc-position="bottom"><img alt="survey" src="../images/survey.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/survey-2.png" data-title="survey-2" data-desc-position="bottom"><img alt="survey-2" src="../images/survey-2.png"></a></p>
<p>Finally, ensure that the Survey is Enabled:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/survey-3.png" data-title="survey-3" data-desc-position="bottom"><img alt="survey-3" src="../images/survey-3.png"></a></p>
<h3 id="workflow-templates">Workflow Templates<a class="headerlink" href="#workflow-templates" title="Permanent link">¤</a></h3>
<p>The Workflow Templates allow you to configure a number of job templates (or other workflow templates) together. This can be useful when you want to use other roles from other collections (see the AAP Certified Content <a href="https://access.redhat.com/support/articles/ansible-automation-platform-certified-content">here</a>) as well as the ansible-devops collection. For example, you might want to run some AWS or VMWare roles to configure resources after or before the ansible-devops collection roles.</p>
<h2 id="how-to-run-a-job">How to run a Job<a class="headerlink" href="#how-to-run-a-job" title="Permanent link">¤</a></h2>
<p>Now you have the Job Template setup, you can launch the Job from that Template. Navigate to the Templates view and click the launch icon:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/job-1.png" data-title="job" data-desc-position="bottom"><img alt="job" src="../images/job-1.png"></a></p>
<p>Enter any survey questions you have configured:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/job-2.png" data-title="job-2" data-desc-position="bottom"><img alt="job-2" src="../images/job-2.png"></a></p>
<p>The Job now launches and you can see the output. The list of executing and executed jobs can be seen from the Jobs seciton</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/job-3.png" data-title="job-3" data-desc-position="bottom"><img alt="job-3" src="../images/job-3.png"></a></p>
<h2 id="examples-of-playbooks">Examples of playbooks<a class="headerlink" href="#examples-of-playbooks" title="Permanent link">¤</a></h2>
<p>You can use the ansbile-devops <a href="https://github.com/ibm-mas/ansible-devops/tree/master/ibm/mas_devops/playbooks">playbooks</a> as a reference on how to setup your own playbooks. Defining your own playbooks gives you full control over what roles can be run and also include your own roles or roles from the supported Red Hat collection.</p>
<p>If you are using the <a href="https://github.com/ibm-mas/ansible-devops/tree/master/ibm/mas_devops/playbooks">playbooks</a> as a starting point then please note the following changes that would be required:</p>
<ul>
<li>Remove any pre_tasks related to environment variables</li>
<li>Remove any lookups of environment variables from the playbook</li>
</ul>
<h3 id="mas_install_coreyml">mas_install_core.yml<a class="headerlink" href="#mas_install_coreyml" title="Permanent link">¤</a></h3>
<p>An example of this is taking the <code>mas_install_core.yml</code> playbook:</p>
<pre><code class="language-yaml">---
- hosts: localhost
  any_errors_fatal: true
  vars:
    # Install SLS
    # Note: We need to create some intermediate variables to construct sls_mongodb_cfg_file,
    # This is the only reason they feature here, all the roles that use these variables would also
    # load them directly from the same environment variables if they were not defined here.
    mas_config_dir: "{{ lookup('env', 'MAS_CONFIG_DIR') }}"
    mongodb_namespace: "{{ lookup('env', 'MONGODB_NAMESPACE') | default('mongoce', True) }}"
    sls_mongodb_cfg_file: "{{ mas_config_dir }}/mongo-{{ mongodb_namespace }}.yml"

    # Core Services Configuration
    mas_channel: "{{ lookup('env', 'MAS_CHANNEL') | default('9.1.x', true) }}"

    # Workspace Configuration
    mas_workspace_name: "{{ lookup('env', 'MAS_WORKSPACE_NAME') | default('MAS Development', true) }}"
    mas_workspace_id: "{{ lookup('env', 'MAS_WORKSPACE_ID') | default('masdev', true) }}"

  pre_tasks:
    # For the full set of supported environment variables refer to the playbook documentation
    - name: Check for required environment variables
      assert:
        that:
          # IBM
          - lookup('env', 'IBM_ENTITLEMENT_KEY') != ""
          # MAS
          - lookup('env', 'MAS_INSTANCE_ID') != ""
          - lookup('env', 'MAS_CONFIG_DIR') != ""
          # SLS
          - (lookup('env', 'SLS_LICENSE_ID') != "" and lookup('env', 'SLS_LICENSE_FILE') != "") or
            (lookup('env', 'SLS_ENTITLEMENT_FILE') != "")
          # DRO
          - lookup('env', 'DRO_CONTACT_EMAIL') != ""
          - lookup('env', 'DRO_CONTACT_FIRSTNAME') != ""
          - lookup('env', 'DRO_CONTACT_LASTNAME') != ""
        fail_msg: "One or more required environment variables are not defined"

  roles:
    # 1. Install cluster-scoped dependencies (e.g. Cert-Manager, Operator Catalogs) &amp; Grafana
    - ibm.mas_devops.ibm_catalogs
    - ibm.mas_devops.cert_manager
    - ibm.mas_devops.grafana

    # 2. Install MongoDb
    - ibm.mas_devops.mongodb

    # 3. Install SLS
    # Set sls_url, sls_tls_crt_local_file_path, sls_registration_key variables to skip install and set up SLSCfg for
    # an existing installation of SLS
    - ibm.mas_devops.sls

    # 4 Install DRO
    - ibm.mas_devops.dro

    # 5. Generate a Workspace
    - ibm.mas_devops.gencfg_workspace

    # 6. Install &amp; configure MAS
    - ibm.mas_devops.suite_dns
    - ibm.mas_devops.suite_certs
    - ibm.mas_devops.suite_install
    - ibm.mas_devops.suite_config
    - ibm.mas_devops.suite_verify
</code></pre>
<p>and changing it to look like the following:</p>
<pre><code class="language-yaml">---
- name: "mas-core"
  hosts: localhost
  any_errors_fatal: true
  vars:
    mas_config_dir: "/tmp"
    mongodb_namespace: "mongoce"
    sls_mongodb_cfg_file: "{{ mas_config_dir }}/mongo-{{ mongodb_namespace }}.yml"

    # Core Services Configuration
    mas_channel: "9.1.x"

    mas_instance_id: "aap1"

    # Workspace Configuration
    mas_workspace_name: "MAS Development"
    mas_workspace_id: "masdev"

    entitlement_file: "license_file/entitlement.lic"

    dro_contact:
      email: "whitfiea@uk.ibm.com"
      first_name: "Andrew"
      last_name: "Whitfield"

  roles:
    # 1. Install cluster-scoped dependencies (e.g. Cert-Manager, Operator Catalogs) &amp; Grafana
    - ibm.mas_devops.ibm_catalogs
    - ibm.mas_devops.cert_manager

    # 2. Install MongoDb
    - ibm.mas_devops.mongodb

    # 3. Install SLS
    - ibm.mas_devops.sls

    # 4 Install DRO
    - ibm.mas_devops.dro

    # 5. Generate a Workspace
    - ibm.mas_devops.gencfg_workspace

    # 6. Install &amp; configure MAS
    - ibm.mas_devops.suite_install
    - ibm.mas_devops.suite_config
    - ibm.mas_devops.suite_verify
</code></pre>
<p>The above has removed any environment variable lookups in the playbook itself, and also modified the roles so it doesn't run the <code>grafana</code> role.</p>
<h3 id="ocp-provision">ocp-provision<a class="headerlink" href="#ocp-provision" title="Permanent link">¤</a></h3>
<p>If you need to set an environment variable then you can do this in the playbook as well, this would be needed in certain cases such as setting the AWS cli details. The <code>aws_access_key_id</code> and <code>aws_secret_access_key</code> are variables set by AAP as a result of the Survey questions:</p>
<pre><code class="language-yaml">---
- name: "ocp-provision"
  hosts: localhost
  vars:
    cluster_name: testcluster
    cluster_type: rosa
    ocp_version: 4.14.35
    rosa_compute_nodes: 3

  environment:
    AWS_DEFAULT_REGION: us-east-1
    AWS_ACCESS_KEY_ID: "{{ aws_access_key_id }}"
    AWS_SECRET_ACCESS_KEY: "{{ aws_secret_access_key }}"

  roles:
    # 1. Provision the ROSA cluster
    - ibm.mas_devops.ocp_provision

    # 2. Login and verify the cluster is ready
    - ibm.mas_devops.ocp_login
    - ibm.mas_devops.ocp_verify

    # 3. Set up storage classes
    - ibm.mas_devops.ocp_efs
</code></pre>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">¤</a></h2>
<h3 id="helpful-links">Helpful Links<a class="headerlink" href="#helpful-links" title="Permanent link">¤</a></h3>
<ul>
<li><a href="https://docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/2.5">Red Hat AAP documentation</a></li>
<li><a href="https://docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/2.5/html/installing_on_openshift_container_platform/index">Installing AAP in OCP</a></li>
<li><a href="https://docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/2.5#Installing">Other install methods of AAP</a></li>
<li><a href="https://access.redhat.com/support/articles/ansible-automation-platform-certified-content">AAP Certified Content</a></li>
</ul>
<h3 id="cant-see-all-output-in-log-file">Can't see all output in log file<a class="headerlink" href="#cant-see-all-output-in-log-file" title="Permanent link">¤</a></h3>
<p>The output for the job doesn't output all the data in the standard view. To see the expanded data you must click on the entry to see the details and then select JSON:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/logs-1.png" data-title="logs-1" data-desc-position="bottom"><img alt="logs-1" src="../images/logs-1.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/logs-2.png" data-title="logs-2" data-desc-position="bottom"><img alt="logs-2" src="../images/logs-2.png"></a></p>
<h3 id="my-playbook-or-updated-playbook-cant-be-found">My playbook or updated playbook can't be found<a class="headerlink" href="#my-playbook-or-updated-playbook-cant-be-found" title="Permanent link">¤</a></h3>
<p>If you have updated your Playbook in your SCM but it is not reflected in AAP then you can sync the Project. Navigate to the Project view and click the <code>sync</code> icon so the Project gets the latest revision.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/sync.png" data-title="sync" data-desc-position="bottom"><img alt="sync" src="../images/sync.png"></a></p>
<h3 id="job-failed-can-i-re-launch-it">Job failed can I re-launch it?<a class="headerlink" href="#job-failed-can-i-re-launch-it" title="Permanent link">¤</a></h3>
<p>If the job fails and you want to relaunch with the same variables (from both hosts and survey), then you can re-launch the job from the Job page or the Jobs list page</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/relaunch.png" data-title="relaunch" data-desc-position="bottom"><img alt="relaunch" src="../images/relaunch.png"></a></p>
<h3 id="how-to-provide-supporting-files">How to provide supporting files?<a class="headerlink" href="#how-to-provide-supporting-files" title="Permanent link">¤</a></h3>
<p>If you have a file that is not a playbook but you want to reference it, then you can include this in the same repo as your playbooks as AAP will be syncing the whole repo. You can then reference these files from your playbook or roles, using a pth relative to the playbook being run. An exmaple of this is the entitlement_file which can be contained in your repo:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/files.png" data-title="files" data-desc-position="bottom"><img alt="files" src="../images/files.png"></a></p>
<p>and then referenced in your playbook in the path <code>"license_file/entitlement.lic"</code>:</p>
<pre><code class="language-yaml">---
- hosts: localhost
  any_errors_fatal: true
  vars:
    mas_config_dir: "/tmp"
    mongodb_namespace: "mongoce"
    sls_mongodb_cfg_file: "{{ mas_config_dir }}/mongo-{{ mongodb_namespace }}.yml"
    entitlement_file: "license_file/entitlement.lic"
  roles:
    - ibm.mas_devops.mongodb
    - ibm.mas_devops.sls
</code></pre>
<h3 id="how-do-i-set-environment-variables">How do I set environment variables?<a class="headerlink" href="#how-do-i-set-environment-variables" title="Permanent link">¤</a></h3>
<p>Running in AAP means you can't set environment variables on the ansible controller before a playbook is executed. If a role in the <code>ibm.mas_devops</code> collection has an environment variable to be set there is normally a corresponding ansible variable. For exmaple, in the documentation for (kafka_action)[https://ibm-mas.github.io/ansible-devops/roles/kafka/#kafka_action] in the <code>kafka</code> role it says to set the environment variable <code>KAFKA_VERSION</code>, this is just setting the ansible role varible called <code>kafka_version</code> which you can set in your playbook. With ansible predence in place, the play vars or role vars will override the default vars that use the environment variable.</p>
<p>Example setting play vars:</p>
<pre><code class="language-yaml">---
- hosts: localhost
  any_errors_fatal: true
  vars:
    kafka_version: 3.7.0
  roles:
    - ibm.mas_devops.kafka
</code></pre>
<p>Example setting role vars:</p>
<pre><code class="language-yaml">---
- hosts: localhost
  any_errors_fatal: true

  roles:
    - role: ibm.mas_devops.kafka
      vars:
        kafka_version: 3.7.0
</code></pre>
      
    </div>
    <!-- <div id="footer" class="rst-content">
      Built with mkdocs v1.6.1 (2025-09-29 10:37:27.816914+00:00)
    </div> -->
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": false, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
</script></body></html>