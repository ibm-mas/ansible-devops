---
- hosts: localhost
  any_errors_fatal: true

  pre_tasks:
    - name: "Load Catalog Metadata"
      ibm.mas_devops.get_catalog_info:
        mas_catalog_version: "{{ catalog_tag }}"
      register: mas_catalog_metadata
    - name: Check for required environment variables
      assert:
        that:
          - lookup('env', 'MIRROR_MODE') != ""
        fail_msg: "One or more required environment variables are not defined"

  roles:
    - ibm.mas_devops.mirror_ocp
