---
- name: Load variables (main)
  include_vars: "vars/main.yml"

# Create config for SLS
- include_tasks: tasks/config_sls/main.yml

# Create config for DRO
- include_tasks: tasks/config_dro/main.yml

# Create config for DRO
- include_tasks: tasks/config_db2/main.yml

# Update CR
# - name: Update AibrokerApp CR
#   kubernetes.core.k8s:
#     state: patched
#     api_version: apps.mas.ibm.com/v1
#     kind: AiBrokerApp
#     name: "{{ mas_instance_id }}"
#     namespace: "{{ aibroker_namespace }}"
#     definition:
#       spec:
#         settings:
#           sls:
#             url: "{{ slscfg.url }}"
#             registration_key: "{{ slscfg.registration_key }}"
#             ca: "{{ slscfg.ca }}"
#           dro:
#             url: "{{ drocfg.url }}"
#             registration_key: "{{ drocfg.registration_key }}"
#             ca: "{{ drocfg.ca }}"
#           jdbc:
#             url: "{{ jdbccfg.url }}"
#             username: "{{ jdbccfg.username }}"
#             password: "{{ jdbccfg.password }}"
#             ca: "{{ jdbccfg.ca }}"
#   ignore_errors: yes
