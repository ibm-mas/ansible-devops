---
- name: Delete WatsonX secret if exists
  kubernetes.core.k8s:
    api_version: v1
    kind: Secret
    name: "{{ aiservice_watsonxai_secret }}"
    state: absent
    namespace: "{{ item }}"
  loop:
    - "{{ aiservice_namespace }}"
    - "{{ tenantNamespace }}"
  ignore_errors: true

- name: Create WatsonX secret
  kubernetes.core.k8s:
    state: present
    template: "templates/watsonx/secret.yml.j2"
  loop:
    - "{{ aiservice_namespace }}"
    - "{{ tenantNamespace }}"
