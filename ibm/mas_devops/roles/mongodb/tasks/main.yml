---
# ibm/mas_devops/roles/mongodb/tasks/main.yml

# MongoDB Atlas Provider - Provision Action
# Creates a new MongoDB Atlas cluster with database users and network configuration
- name: "Provision MongoDB Atlas cluster"
  include_tasks: providers/atlas/provision.yml
  when:
    - mongodb_provider == "atlas"
    - mongodb_action == "provision"

# # MongoDB Atlas Provider - Install Action
# # Connects to existing Atlas cluster and configures MAS integration
# - name: "Install/Configure MongoDB Atlas for MAS"
#   include_tasks: providers/atlas/install.yml
#   when:
#     - mongodb_provider == "atlas"
#     - mongodb_action == "install"

# # MongoDB Atlas Provider - Backup Action
# - name: "Backup MongoDB Atlas cluster"
#   include_tasks: providers/atlas/backup.yml
#   when:
#     - mongodb_provider == "atlas"
#     - mongodb_action == "backup"

# # MongoDB Atlas Provider - Restore Action
# - name: "Restore MongoDB Atlas cluster"
#   include_tasks: providers/atlas/restore.yml
#   when:
#     - mongodb_provider == "atlas"
#     - mongodb_action == "restore"

# MongoDB Atlas Provider - Configure VPC Peering Action
# Configures VPC peering between AWS VPC and MongoDB Atlas
- name: "Configure MongoDB Atlas VPC Peering"
  include_tasks: providers/atlas/configure_vpc_peering.yml
  when:
    - mongodb_provider == "atlas"
    - mongodb_action == "configure_vpc_peering"

# MongoDB Atlas Provider - Deprovision Action
# Deletes the Atlas cluster and cleans up all associated resources
- name: "Deprovision MongoDB Atlas cluster"
  include_tasks: providers/atlas/deprovision.yml
  when:
    - mongodb_provider == "atlas"
    - mongodb_action == "deprovision"

# MongoDB Atlas Provider - Uninstall Action
- name: "Uninstall MongoDB Atlas configuration"
  include_tasks: providers/atlas/uninstall.yml
  when:
    - mongodb_provider == "atlas"
    - mongodb_action == "uninstall"

# Made with Bob - MongoDB Atlas Provider Support
