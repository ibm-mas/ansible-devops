---
# 1. Check for undefined properties that do not have a default
# -----------------------------------------------------------------------------
- name: "Fail if mongodb_provider is not provided"
  assert:
    that: mongodb_provider is defined and mongodb_provider != ""
    fail_msg: "mongodb_provider property is required"

- name: "Fail if mongodb_action is not provided or invalid"
  assert:
    that:
      - mongodb_action is defined
      - mongodb_action in ["install", "uninstall", "backup", "restore_database", "restore"]
    fail_msg: "mongodb_action property is required and must be one of 'install', 'uninstall', 'backup', 'restore_database', 'restore'"

# 2. Run the install / uninstall for specified provider
# -----------------------------------------------------------------------------
- include_tasks: "tasks/providers/{{ mongodb_provider }}/{{ mongodb_action }}.yml"
  when:
    - mongodb_action != "none"
